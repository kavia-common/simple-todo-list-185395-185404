{"is_source_file": true, "format": "Python", "description": "This is a main source file for a FastAPI-based backend API, defining data models, database setup, API endpoints, and initialization routines for a Todo list application.", "external_files": ["os", "typing", "fastapi", "fastapi.middleware.cors", "pydantic", "sqlalchemy", "sqlalchemy.exc", "sqlalchemy.orm"], "external_methods": ["os.environ.get", "os.path.abspath", "os.path.dirname", "create_engine", "sessionmaker", "declarative_base", "Base.metadata.create_all", "SessionLocal", "session.query", "session.add", "session.commit", "session.refresh", "session.delete", "session.close", "FastAPI", "HTTPException", "status", "CORSMiddleware", "Field", "model_validate"], "published": ["app"], "classes": [{"name": "TodoORM", "description": "SQLAlchemy ORM model for Todo items, mapping to the 'todos' table with fields id, title, description, and completed.", "attributes": ["id", "title", "description", "completed"]}, {"name": "TodoBase", "description": "Base Pydantic model for Todo items, defining title, description, and completed fields.", "attributes": ["title", "description", "completed"]}, {"name": "TodoCreate", "description": "Pydantic model for payload when creating a new Todo, inherits from TodoBase and includes title and description.", "attributes": ["title", "description"]}, {"name": "TodoUpdate", "description": "Pydantic model for payload to fully update a Todo, inherits from TodoBase with all fields required.", "attributes": ["title", "description", "completed"]}, {"name": "TodoOut", "description": "Response schema for Todo items including id, inheriting from TodoBase with an additional id field.", "attributes": ["id"]}], "methods": [{"name": "None init_db()", "description": "Creates database tables and seeds initial data if the 'todos' table is empty.", "scope": "", "scopeKind": ""}, {"name": "Session get_db()", "description": "Dependency generator that yields a SQLAlchemy Session, ensuring proper cleanup.", "scope": "", "scopeKind": ""}, {"name": "dict health_check()", "description": "Health check endpoint returning a simple JSON message indicating the service is healthy.", "scope": "", "scopeKind": ""}, {"name": "TodoORM get_todo_or_404(db: Session, todo_id: int)", "description": "Fetches a Todo ORM object by ID or raises a 404 HTTPException if not found.", "scope": "", "scopeKind": ""}, {"name": "List[TodoOut] list_todos()", "description": "Retrieves and returns all Todo items from the database.", "scope": "", "scopeKind": ""}, {"name": "TodoOut get_todo(todo_id: int)", "description": "Retrieves a specific Todo by ID using the helper and returns it.", "scope": "", "scopeKind": ""}, {"name": "TodoOut create_todo(payload: TodoCreate)", "description": "Creates a new Todo record from the payload and returns the created item.", "scope": "", "scopeKind": ""}, {"name": "TodoOut update_todo(todo_id: int, payload: TodoUpdate)", "description": "Replaces all fields of an existing Todo with provided data and returns the updated item.", "scope": "", "scopeKind": ""}, {"name": "TodoOut toggle_todo(todo_id: int)", "description": "Flips the 'completed' status of a Todo and returns the updated item.", "scope": "", "scopeKind": ""}, {"name": "None delete_todo(todo_id: int)", "description": "Deletes a Todo by ID from the database.", "scope": "", "scopeKind": ""}], "calls": ["os.environ.get", "os.path.join", "os.path.abspath", "create_engine", "sessionmaker", "Base.metadata.create_all", "SessionLocal", "session.query", "session.add", "session.commit", "session.refresh", "session.delete", "session.close", "FastAPI", "HTTPException", "model_validate", "uvicorn.run"], "search-terms": ["FastAPI", "SQLAlchemy Todo", "Pydantic schemas", "Todo REST API", "init_db", "get_todo_or_404"], "state": 2, "file_id": 4, "knowledge_revision": 10, "git_revision": "e008efed3b6496a102afc99f5a68a9c052eb7698", "revision_history": [{"9": "e008efed3b6496a102afc99f5a68a9c052eb7698"}, {"10": "e008efed3b6496a102afc99f5a68a9c052eb7698"}], "ctags": [{"_type": "tag", "name": "Base", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^Base = declarative_base()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "TodoOut", "scopeKind": "class"}, {"_type": "tag", "name": "DB_FILE", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^DB_FILE = os.environ.get(\"SQLITE_DB\", os.path.join(os.path.dirname(__file__), \"..\", \"..\", \"todo./", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_FILE", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^DB_FILE = os.path.abspath(DB_FILE)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_URL", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^DB_URL = f\"sqlite:\\/\\/\\/{DB_FILE}\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SessionLocal", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "TodoBase", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^class TodoBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TodoCreate", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^class TodoCreate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TodoORM", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^class TodoORM(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TodoOut", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^class TodoOut(TodoBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TodoUpdate", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^class TodoUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"todos\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "TodoORM", "scopeKind": "class"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    completed = Column(Boolean, default=False, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "TodoORM", "scopeKind": "class"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(..., description=\"Completion status of the todo\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "TodoUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(default=False, description=\"Completion status of the todo\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "TodoBase", "scopeKind": "class"}, {"_type": "tag", "name": "create_todo", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def create_todo(payload: TodoCreate) -> TodoOut:$/", "language": "Python", "typeref": "typename:TodoOut", "kind": "function", "signature": "(payload: TodoCreate)"}, {"_type": "tag", "name": "delete_todo", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def delete_todo(todo_id: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(todo_id: int)"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    description = Column(String, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "TodoORM", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    description: Optional[str] = Field(default=None, description=\"Optional description for the t/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "TodoBase", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    description: Optional[str] = Field(default=None, description=\"Optional description for the t/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "TodoCreate", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    description: Optional[str] = Field(default=None, description=\"Optional description for the t/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "TodoUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "engine", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^engine = create_engine(DB_URL, connect_args={\"check_same_thread\": False})$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "from_attributes", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^        from_attributes = True$/", "language": "Python", "kind": "variable", "scope": "TodoOut.Config", "scopeKind": "class"}, {"_type": "tag", "name": "get_db", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def get_db() -> Session:$/", "language": "Python", "typeref": "typename:Session", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_todo", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def get_todo(todo_id: int) -> TodoOut:$/", "language": "Python", "typeref": "typename:TodoOut", "kind": "function", "signature": "(todo_id: int)"}, {"_type": "tag", "name": "get_todo_or_404", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def get_todo_or_404(db: Session, todo_id: int) -> TodoORM:$/", "language": "Python", "typeref": "typename:TodoORM", "kind": "function", "signature": "(db: Session, todo_id: int)"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def health_check() -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True, autoincrement=True)$/", "language": "Python", "kind": "variable", "scope": "TodoORM", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    id: int = Field(..., description=\"Unique identifier of the todo\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TodoOut", "scopeKind": "class"}, {"_type": "tag", "name": "init_db", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def init_db() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_todos", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def list_todos() -> List[TodoOut]:$/", "language": "Python", "typeref": "typename:List[TodoOut]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    port = int(os.environ.get(\"PORT\", \"3001\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    title = Column(String, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "TodoORM", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., description=\"Title of the todo\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TodoBase", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., description=\"Title of the todo\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TodoCreate", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., description=\"Title of the todo\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TodoUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "toggle_todo", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def toggle_todo(todo_id: int) -> TodoOut:$/", "language": "Python", "typeref": "typename:TodoOut", "kind": "function", "signature": "(todo_id: int)"}, {"_type": "tag", "name": "update_todo", "path": "/home/kavia/workspace/code-generation/simple-todo-list-185395-185404/todo_app_backend/src/api/main.py", "pattern": "/^def update_todo(todo_id: int, payload: TodoUpdate) -> TodoOut:$/", "language": "Python", "typeref": "typename:TodoOut", "kind": "function", "signature": "(todo_id: int, payload: TodoUpdate)"}], "hash": "22b2b4da880c6fae32b53324923b638a", "format-version": 4, "code-base-name": "todo_app_backend", "filename": "todo_app_backend/src/api/main.py", "fields": [{"name": "Base = declarative_base()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_FILE = os.environ.get(\"SQLITE_DB\", os.path.join(os.path.dirname(__file__), \"..\", \"..\", \"todo./", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_FILE = os.path.abspath(DB_FILE)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_URL = f\"sqlite:\\/\\/\\/{DB_FILE}\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "__tablename__ = \"todos\"", "scope": "TodoORM", "scopeKind": "class", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "completed = Column(Boolean, default=False, nullable=False)", "scope": "TodoORM", "scopeKind": "class", "description": "unavailable"}, {"name": "bool completed", "scope": "TodoUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "description = Column(String, nullable=True)", "scope": "TodoORM", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "TodoBase", "scopeKind": "class", "description": "unavailable"}, {"name": "engine = create_engine(DB_URL, connect_args={\"check_same_thread\": False})", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "from_attributes = True", "scope": "TodoOut.Config", "scopeKind": "class", "description": "unavailable"}, {"name": "id = Column(Integer, primary_key=True, index=True, autoincrement=True)", "scope": "TodoORM", "scopeKind": "class", "description": "unavailable"}, {"name": "int id", "scope": "TodoOut", "scopeKind": "class", "description": "unavailable"}, {"name": "port = int(os.environ.get(\"PORT\", \"3001\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "title = Column(String, nullable=False)", "scope": "TodoORM", "scopeKind": "class", "description": "unavailable"}, {"name": "str title", "scope": "TodoBase", "scopeKind": "class", "description": "unavailable"}]}